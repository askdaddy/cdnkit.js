/*! cdnkit.js build:1.0.0, production. Copyright(c) 2015 Seven Chen <humen1@gmail.com> */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,b.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,b.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},{}],2:[function(a,b,c){function d(a){return this instanceof d?(f.call(this),this.log=e.log,this._conf=e.config,this.ele=a,this.url=this.ele.getAttribute(this._conf.kitTag),this.blob=null,this.blobURL=null,this.onload=function(){},void this.load()):new d(a)}var e=a("./util"),f=a("eventemitter3"),g=window.Blob||window.WebkitBlob,h=window.URL||window.webkitURL;e.inherits(d,f),d.prototype.key=function(){return this.url},d.prototype.load=function(){var a=this,b=new XMLHttpRequest;b.responseType="arraybuffer",b.open("GET",a.url,!0),b.onload=function(c){a.log(c);var d=new Uint8Array(b.response),e=b.getResponseHeader("Content-Type");e=e?e.split(";")[0]:"image/jpeg",a.blob=new g([d],{type:e}),a.log(a.blob);var f=h.createObjectURL(a.blob);a.blobURL=a.ele.src=f,a.onload()},b.onerror=function(b){a.log(b.error,err)},b.send()},d.prototype.release=function(){h.revokeObjectURL(this.blobURL)},b.exports=d},{"./util":8,eventemitter3:9}],3:[function(a,b,c){arguments[4][2][0].apply(c,arguments)},{"./util":8,dup:2,eventemitter3:9}],4:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);f.call(this);var b=this;return this._conf=e.config,e.isSupportedBrowser()?(a=e.extend({debug:!0,useCache:!0,instrument:!1,numConns:1,fetcherTimeout:2500,initCacheTimeout:2500,defaultExpiry:(new Date).getTime()+5e5},a),this._options=a,e.debug=this._options.debug,void document.addEventListener("DOMContentLoaded",function(){b._init()},!1)):(document.addEventListener("DOMContentLoaded",function(){e.log("Unsupported browser");for(var a=document.querySelectorAll("["+this._conf.kitTag+"]"),b=0;b<a.length;b+=1){var c=a[b];c.src=c.getAttribute(this._conf.kitTag)}},!1),void e.setZeroTimeout(function(){b.emit("error",new Error("Browser not supported"))}))}var e=a("./util"),f=a("eventemitter3"),g=a("./dom");e.inherits(d,f),d.prototype._init=function(){this._dom=new g({}),this._dom.init()},b.exports=d},{"./dom":5,"./util":8,eventemitter3:9}],5:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);f.call(this);this._conf=e.config,this._resources=new h,a=e.extend({types:["img["+this._conf.kitTag+"]"]},a),this._options=a}var e=a("./util"),f=a("eventemitter3"),g=a("./blobimage"),h=a("./resources");e.inherits(d,f),d.prototype.init=function(){for(var a=this,b=document.querySelectorAll(this._options.types.join(",")),c=0;c<b.length;++c){var e=b[c],f=new d.handler[e.tagName](e);a._resources.push(f)}},d.handler={IMG:g},b.exports=d},{"./blobimage":3,"./resources":7,"./util":8,eventemitter3:9}],6:[function(a,b,c){window.RTCPeerConnection=a("./adapter").RTCPeerConnection,window.RTCSessionDescription=a("./adapter").RTCSessionDescription,window.RTCIceCandidate=a("./adapter").RTCIceCandidate,window.DomActor=a("./dom"),window.CdnKit=a("./cdnkit"),window.util=a("./util"),window.Resources=a("./resources"),window.BlobImage=a("./blobImage")},{"./adapter":1,"./blobImage":2,"./cdnkit":4,"./dom":5,"./resources":7,"./util":8}],7:[function(a,b,c){function d(){return this instanceof d?(f.call(this),void(this._res={})):new d}var e=a("./util"),f=a("eventemitter3");e.inherits(d,f),d.prototype.push=function(a){var b=this;b._res[a.key()]=a},b.exports=d},{"./util":8,eventemitter3:9}],8:[function(a,b,c){var d={kitTag:"data-cdnkit-src",iceServers:[{url:"stun:stun.l.google.com:19302"}]},e={config:d,debug:!1,logLevel:0,setLogLevel:function(a){var b=parseInt(a,10);isNaN(parseInt(a,10))?e.logLevel=a?3:0:e.logLevel=b,e.log=e.warn=e.error=e.noop,e.logLevel>0&&(e.error=e._printWith("ERROR")),e.logLevel>1&&(e.warn=e._printWith("WARNING")),e.logLevel>2&&(e.log=e._print)},browser:function(){return window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported"}(),inherits:function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})},extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},log:function(){if(e.debug){var a=!1,b=Array.prototype.slice.call(arguments);b.unshift("CDNKit: ");for(var c=0,d=b.length;d>c;c++)b[c]instanceof Error&&(b[c]="("+b[c].name+") "+b[c].message,a=!0)}},isSecure:function(){return"https:"===location.protocol},isSupportedBrowser:function(){var a,b=navigator.appName,c=navigator.userAgent,d=c.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);d&&null!=(a=c.match(/version\/([\.\d]+)/i))&&(d[2]=a[1]),d=d?[d[1],d[2]]:[b,navigator.appVersion,"-?"];var e=d[1].split("."),f={name:d[0],versions:e};if("Chrome"===f.name){var g=parseInt(f.versions[0],10);return g>26?!0:26===g&&parseInt(f.versions[2],10)>1403?!0:!1}return!1}};b.exports=e},{}],9:[function(a,b,c){"use strict";function d(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function e(){}e.prototype._events=void 0,e.prototype.listeners=function(a){if(!this._events||!this._events[a])return[];if(this._events[a].fn)return[this._events[a].fn];for(var b=0,c=this._events[a].length,d=new Array(c);c>b;b++)d[b]=this._events[a][b].fn;return d},e.prototype.emit=function(a,b,c,d,e,f){if(!this._events||!this._events[a])return!1;var g,h,i=this._events[a],j=arguments.length;if("function"==typeof i.fn){switch(i.once&&this.removeListener(a,i.fn,!0),j){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,b),!0;case 3:return i.fn.call(i.context,b,c),!0;case 4:return i.fn.call(i.context,b,c,d),!0;case 5:return i.fn.call(i.context,b,c,d,e),!0;case 6:return i.fn.call(i.context,b,c,d,e,f),!0}for(h=1,g=new Array(j-1);j>h;h++)g[h-1]=arguments[h];i.fn.apply(i.context,g)}else{var k,l=i.length;for(h=0;l>h;h++)switch(i[h].once&&this.removeListener(a,i[h].fn,!0),j){case 1:i[h].fn.call(i[h].context);break;case 2:i[h].fn.call(i[h].context,b);break;case 3:i[h].fn.call(i[h].context,b,c);break;default:if(!g)for(k=1,g=new Array(j-1);j>k;k++)g[k-1]=arguments[k];i[h].fn.apply(i[h].context,g)}}return!0},e.prototype.on=function(a,b,c){var e=new d(b,c||this);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},e.prototype.once=function(a,b,c){var e=new d(b,c||this,!0);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},e.prototype.removeListener=function(a,b,c){if(!this._events||!this._events[a])return this;var d=this._events[a],e=[];if(b&&(d.fn&&(d.fn!==b||c&&!d.once)&&e.push(d),!d.fn))for(var f=0,g=d.length;g>f;f++)(d[f].fn!==b||c&&!d[f].once)&&e.push(d[f]);return e.length?this._events[a]=1===e.length?e[0]:e:delete this._events[a],this},e.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[a]:this._events={},this):this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prototype.setMaxListeners=function(){return this},e.EventEmitter=e,e.EventEmitter2=e,e.EventEmitter3=e,b.exports=e},{}]},{},[6]);